

<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Operators &#8212; cuBLASDx</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/nvidia-sphinx-theme.css?v=df3ac72c" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=757451c5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/operators';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.nvidia.com/cuda/cublasdx/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.4.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="icon" href="../_static/nvidia.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Traits" href="traits.html" />
    <link rel="prev" title="Achieving High Performance" href="../performance.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.4.0" />


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="cuBLASDx - Home"/>
    <img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="cuBLASDx - Home"/>
  
  
    <p class="title logo__title">cuBLASDx</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="cuBLASDx - Home"/>
    <img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="cuBLASDx - Home"/>
  
  
    <p class="title logo__title">cuBLASDx</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">



<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Documentation Home</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../requirements_func.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_cublasdx.html">Using cuBLASDx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance.html">Achieving High Performance</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="traits.html">Traits</a></li>
<li class="toctree-l1"><a class="reference internal" href="methods.html">Execution Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_methods.html">Other Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_tensors.html">Tensor Manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_shared.html">Shared Memory Management</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../python_bindings.html">cuBLASDx Python Bindings</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/MathDx/cuBLASDx">GitHub Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MathDx</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://developer.nvidia.com/cublasdx-downloads">cuBLASDx</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.nvidia.com/cufftdx-downloads">cuFFTDx</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.nvidia.com/cusolverdx-downloads">cuSolverDx</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.nvidia.com/curanddx-downloads">cuRANDDx</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.nvidia.com/nvcompdx-downloads">nvCOMPDx</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Operators</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="operators">
<span id="operators-label"></span><h1>Operators<a class="headerlink" href="#operators" title="Link to this heading">#</a></h1>
<p>Operators are used to describe the properties and to configure the execution of the problem we want to solve. They are divided into
<a class="reference internal" href="#description-operators-label"><span class="std std-ref">Description Operators</span></a> and <a class="reference internal" href="#execution-operators-label"><span class="std std-ref">Execution Operators</span></a>.</p>
<hr class="docutils" />
<section id="description-operators">
<span id="description-operators-label"></span><h2>Description Operators<a class="headerlink" href="#description-operators" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Default Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#size-operator-label"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Size</span><span class="o">&lt;</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="o">&gt;</span></code></a></p></td>
<td><p>Not set</p></td>
<td><p>Defines the problem size.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#function-operator-label"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Function</span><span class="o">&lt;</span><span class="n">function</span><span class="o">&gt;</span></code></a></p></td>
<td><p>Not set</p></td>
<td><p>BLAS function. Use <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">function</span><span class="o">::</span><span class="n">MM</span></code> for <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">GEMM</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#arrangement-operator-label"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Arrangement</span><span class="o">&lt;</span><span class="n">arrangement</span><span class="p">,</span><span class="w"> </span><span class="n">arrangement</span><span class="p">,</span><span class="w"> </span><span class="n">arrangement</span><span class="o">&gt;</span></code></a></p></td>
<td><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">row_major</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">col_major</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">col_major</span></code></p></td>
<td><p>Arrangement of each matrix in global memory and default arrangement in shared memory.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#transposemode-operator-label"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">TransposeMode</span><span class="o">&lt;</span><span class="n">transpose_mode</span><span class="p">,</span><span class="w"> </span><span class="n">transpose_mode</span><span class="o">&gt;</span></code></a></p></td>
<td><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">transposed</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">non</span><span class="o">-</span><span class="n">transposed</span></code></p></td>
<td><p>Transpose mode of the each matrix (Deprecated since 0.2.0).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#precision-operator-label"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Precision</span><span class="o">&lt;</span><span class="n">PA</span><span class="p">,</span><span class="w"> </span><span class="n">PB</span><span class="p">,</span><span class="w"> </span><span class="n">PC</span><span class="o">&gt;</span></code></a></p></td>
<td><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">float</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">float</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">float</span></code></p></td>
<td><p>Computation Precision of GEMM <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code>, and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> - either all floating point or all integral.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#type-operator-label"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Type</span><span class="o">&lt;</span><span class="n">type</span><span class="o">&gt;</span></code></a></p></td>
<td><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">type</span><span class="o">::</span><span class="n">real</span></code></p></td>
<td><p>Type of input and output data (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">type</span><span class="o">::</span><span class="n">real</span></code> or <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">type</span><span class="o">::</span><span class="n">complex</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#leadingdimension-operator-label"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LeadingDimension</span><span class="o">&lt;</span><span class="n">LDA</span><span class="p">,</span><span class="w"> </span><span class="n">LDB</span><span class="p">,</span><span class="w"> </span><span class="n">LDC</span><span class="o">&gt;</span></code></a></p></td>
<td><p>As defined by <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Size</span></code>, and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Arrangement</span></code> or <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">TransposeMode</span></code> operators</p></td>
<td><p>Leading dimensions for matrices <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#alignment-operator-label"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Alignment</span><span class="o">&lt;</span><span class="n">a_align</span><span class="p">,</span><span class="w"> </span><span class="n">b_align</span><span class="p">,</span><span class="w"> </span><span class="n">c_align</span><span class="o">&gt;</span></code></a></p></td>
<td><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="k">alignof</span><span class="p">(</span><span class="n">BLAS</span><span class="o">::</span><span class="n">a_value_type</span><span class="p">)</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="k">alignof</span><span class="p">(</span><span class="n">BLAS</span><span class="o">::</span><span class="n">b_value_type</span><span class="p">)</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="k">alignof</span><span class="p">(</span><span class="n">BLAS</span><span class="o">::</span><span class="n">c_value_type</span><span class="p">)</span></code></p></td>
<td><p>Alignments (in bytes) of matrices <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#sm-operator-label"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">SM</span><span class="o">&lt;</span><span class="n">CC</span><span class="o">&gt;</span></code></a></p></td>
<td><p>Not set</p></td>
<td><p>Target CUDA architecture for which the BLAS function should be generated.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Description operators define the problem we want to solve.
Combined with <a class="reference internal" href="#execution-operators-label"><span class="std std-ref">Execution Operators</span></a>, they form a complete function descriptor that can be executed on a GPU.</p>
<p>Operators are added (in arbitrary order) to construct the operation descriptor type. For example, to describe a matrix multiplication
for non-transposed matrices A (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">m</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">k</span></code>), B (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">k</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">n</span></code>), C (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">m</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">n</span></code>) with complex double precision values where <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">16</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span></code> for
execution on Volta architecture, one would write:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cublasdx.hpp&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="n">GEMM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">decltype</span><span class="p">(</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Size</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Precision</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Type</span><span class="o">&lt;</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">type</span><span class="o">::</span><span class="n">complex</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Arrangement</span><span class="o">&lt;</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">col_major</span><span class="p">,</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">col_major</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Function</span><span class="o">&lt;</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">function</span><span class="o">::</span><span class="n">MM</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">SM</span><span class="o">&lt;</span><span class="mi">700</span><span class="o">&gt;</span><span class="p">());</span>
</pre></div>
</div>
<p>For a function descriptor to be complete, the following is required:</p>
<blockquote>
<div><ul class="simple">
<li><p>One, and only one, <a class="reference internal" href="#size-operator-label"><span class="std std-ref">Size Operator</span></a>.</p></li>
<li><p>One, and only one, <a class="reference internal" href="#arrangement-operator-label"><span class="std std-ref">Arrangement Operator</span></a> or <a class="reference internal" href="#transposemode-operator-label"><span class="std std-ref">TransposeMode Operator</span></a>.</p></li>
<li><p>One, and only one, <a class="reference internal" href="#function-operator-label"><span class="std std-ref">Function Operator</span></a>.</p></li>
<li><p>One, and only one, <a class="reference internal" href="#sm-operator-label"><span class="std std-ref">SM Operator</span></a>.</p></li>
</ul>
</div></blockquote>
<section id="size-operator">
<span id="size-operator-label"></span><h3>Size Operator<a class="headerlink" href="#size-operator" title="Link to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Size</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">K</span><span class="o">&gt;</span><span class="p">()</span>
</pre></div>
</div>
<p>Sets the problem size of the function to be executed.</p>
<p>For <a class="reference internal" href="#function-operator-gemm-label"><span class="std std-ref">GEMM</span></a>:</p>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">M</span></code> - logical number of rows in matrices <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">op</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></code> and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code>.</p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">N</span></code> - logical number of columns in matrices <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">op</span><span class="p">(</span><span class="n">B</span><span class="p">)</span></code> and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code>.</p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">K</span></code> - logical number of columns in matrix <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">op</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></code> and rows in <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code>.</p></li>
</ul>
<p>For example, for GEMM <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">M</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">N</span></code>, and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">K</span></code> specify that the <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">M</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">K</span></code>) matrix is multiplied by <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code> (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">K</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">N</span></code>) matrix which results in <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">M</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">N</span></code>) matrix (assuming <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code> are non-transposed). See <a class="reference internal" href="#arrangement-operator-label"><span class="std std-ref">Arrangement</span></a>, <a class="reference internal" href="#transposemode-operator-label"><span class="std std-ref">TransposeMode</span></a> and <a class="reference internal" href="#function-operator-gemm-label"><span class="std std-ref">GEMM</span></a>.</p>
</section>
<section id="type-operator">
<span id="type-operator-label"></span><h3>Type Operator<a class="headerlink" href="#type-operator" title="Link to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cubladx</span><span class="o">::</span><span class="n">Type</span><span class="o">&lt;</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">type</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">cublasdx</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">type</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">real</span><span class="p">,</span>
<span class="w">    </span><span class="n">complex</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sets the type of input and output data used in computation. Use <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">type</span><span class="o">::</span><span class="n">real</span></code> for real data type, and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">type</span><span class="o">::</span><span class="n">complex</span></code> for complex data type.</p>
</section>
<section id="precision-operator">
<span id="precision-operator-label"></span><h3>Precision Operator<a class="headerlink" href="#precision-operator" title="Link to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Precision</span><span class="o">&lt;</span><span class="n">PA</span><span class="p">,</span><span class="w"> </span><span class="n">PB</span><span class="o">=</span><span class="n">PA</span><span class="p">,</span><span class="w"> </span><span class="n">PC</span><span class="o">=</span><span class="n">PA</span><span class="o">&gt;</span><span class="p">;</span>
</pre></div>
</div>
<p>Sets the precision of computation for <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code>, and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code>.</p>
<p>The precision type can be either floating :</p>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">__half</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">float</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">double</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">__nv_fp8_e5m2</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">__nv_fp8_e4m3</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">__nv_bfloat16</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">cublasdx</span><span class="o">::</span><span class="n">tfloat32_t</span></code></p></li>
</ul>
<p>or integral:</p>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">int8_t</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">uint8_t</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">int16_t</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">uint16_t</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">int32_t</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">uint32_t</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">int64_t</span></code></p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">uint64_t</span></code></p></li>
</ul>
<p>It describes the <strong>computation precision</strong> for the values used for input and output. This means that this is the
type to which the input values will be converted just before executing the multiplication instruction.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Starting from cuBLASDx 0.3.0, <strong>computational precision has been decoupled from data precision</strong>, i.e. the input / output data for each matrix can be of arbitrary type (even integral input for floating point GEMM) provided that <a class="reference internal" href="#alignment-operator-label"><span class="std std-ref">Alignment Operator</span></a> is set and at least one of those conditions is met:</p>
<ol class="arabic simple">
<li><p>It’s implicitly convertible to the data type chosen with <a class="reference internal" href="#precision-operator-label"><span class="std std-ref">Precision Operator</span></a> and <a class="reference internal" href="#type-operator-label"><span class="std std-ref">Type Operator</span></a>.</p></li>
<li><p>For inputs: An appropriate converting loading operation is provided as one of the arguments. It takes the input type value. Its result must be at least implicitly convertible to the compute type.</p></li>
<li><p>For output: An appropriate converting storing operation is provided as one of the arguments. It takes the result computational type (usually <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> type as defined by <a class="reference internal" href="#precision-operator-label"><span class="std std-ref">Precision Operator</span></a> and <a class="reference internal" href="#type-operator-label"><span class="std std-ref">Type Operator</span></a>). Its result must be at least implicitly convertible to the output type.</p></li>
</ol>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If using computation precision decoupled from input types, the <a class="reference internal" href="#alignment-operator-label"><span class="std std-ref">Alignment Operator</span></a> must be explicitly set.</p>
</div>
</section>
<section id="arrangement-operator">
<span id="arrangement-operator-label"></span><h3>Arrangement Operator<a class="headerlink" href="#arrangement-operator" title="Link to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Arrangement</span><span class="o">&lt;</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">arrangement</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">arrangement</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">col_major</span><span class="p">,</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">arrangement</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">col_major</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">cublasdx</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">arrangement</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">col_major</span><span class="p">,</span>
<span class="w">    </span><span class="n">row_major</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">col_major</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">arrangement</span><span class="o">::</span><span class="n">col_major</span><span class="p">;</span>
<span class="w">  </span><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">left_layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arrangement</span><span class="o">::</span><span class="n">col_major</span><span class="p">;</span>
<span class="w">  </span><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">row_major</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">arrangement</span><span class="o">::</span><span class="n">row_major</span><span class="p">;</span>
<span class="w">  </span><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">right_major</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arrangement</span><span class="o">::</span><span class="n">row_major</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sets the order for <strong>global</strong> <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code>, and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> matrices used in the function. The order can be either column-major or row-major.
Arrangement operator directly influences <a class="reference internal" href="other_methods.html#get-layout-other-label"><span class="std std-ref">Get Memory Layout</span></a> and <a class="reference internal" href="other_methods.html#suggest-layout-other-label"><span class="std std-ref">Suggested shared memory Layout</span></a> methods, by explicitly
setting the default <a class="reference internal" href="other_methods.html#get-layout-other-label"><span class="std std-ref">Get Memory Layout</span></a> value and choosing <a class="reference internal" href="other_methods.html#suggest-layout-other-label"><span class="std std-ref">Suggested shared memory Layout</span></a> for optimized global-shared
transfers.</p>
<p>Selecting a specific order for matrices doesn’t mean the function doesn’t accept matrices with different layouts, but it
may influence the overall performance.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Arrangement</span></code> and <a class="reference internal" href="#transposemode-operator-label"><span class="std std-ref">TransposeMode</span></a> operators can’t be defined at the same time.</p>
</div>
</section>
<section id="transposemode-operator">
<span id="transposemode-operator-label"></span><h3>TransposeMode Operator<a class="headerlink" href="#transposemode-operator" title="Link to this heading">#</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">TransposeMode</span></code> operator is deprecated since 0.2.0 and may be removed in future versions.</p>
</div>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cublasdx</span><span class="o">::</span><span class="n">TransposeMode</span><span class="o">&lt;</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">transpose_mode</span><span class="w"> </span><span class="n">ATransposeMode</span><span class="p">,</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">transpose_mode</span><span class="w"> </span><span class="n">BTransposeMode</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">cublasdx</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">transpose_mode</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">non_transposed</span><span class="p">,</span>
<span class="w">    </span><span class="n">transposed</span><span class="p">,</span>
<span class="w">    </span><span class="n">conj_transposed</span><span class="p">,</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transpose_mode</span><span class="o">::</span><span class="n">non_transposed</span><span class="p">;</span>
<span class="w">  </span><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transpose_mode</span><span class="o">::</span><span class="n">transposed</span><span class="p">;</span>
<span class="w">  </span><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">C</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transpose_mode</span><span class="o">::</span><span class="n">conj_transposed</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sets the transpose mode for the <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code> matrices used in the function.
For example, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">TransposeMode</span><span class="o">&lt;</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;</span><span class="p">()</span></code> sets transpose mode of <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code> matrix as <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">non</span><span class="o">-</span><span class="n">transposed</span></code> for GEMM.
Possible values for transpose mode are:</p>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">transpose_mode</span><span class="o">::</span><span class="n">non_transposed</span></code>,</p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">transpose_mode</span><span class="o">::</span><span class="n">transposed</span></code>, and</p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">transpose_mode</span><span class="o">::</span><span class="n">conj_transposed</span></code> (conjugated transposed).</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p><a class="reference internal" href="#arrangement-operator-label"><span class="std std-ref">Arrangement</span></a> and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">TransposeMode</span></code> operators can’t be defined at the same time.</p></li>
<li><p>Using <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">transpose_mode</span><span class="o">::</span><span class="n">non_transposed</span></code> for a matrix in <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">TransposeMode</span></code> operator corresponds to <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">arrangement</span><span class="o">::</span><span class="n">col_major</span></code> in <a class="reference internal" href="#arrangement-operator-label"><span class="std std-ref">Arrangement</span></a> operator.</p></li>
<li><p>Using <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">transpose_mode</span><span class="o">::</span><span class="n">transposed</span></code> for a matrix in <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">TransposeMode</span></code> operator corresponds to <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">arrangement</span><span class="o">::</span><span class="n">row_major</span></code> in <a class="reference internal" href="#arrangement-operator-label"><span class="std std-ref">Arrangement</span></a> operator.</p></li>
<li><p>Using <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">transpose_mode</span><span class="o">::</span><span class="n">conj_transposed</span></code> for a matrix in <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">TransposeMode</span></code> operator corresponds to <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">arrangement</span><span class="o">::</span><span class="n">row_major</span></code> in <a class="reference internal" href="#arrangement-operator-label"><span class="std std-ref">Arrangement</span></a> operator and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">cublasdx</span><span class="o">::</span><span class="n">conjugate</span></code> passed in <a class="reference internal" href="methods.html#execution-methods-label"><span class="std std-ref">execute()</span></a> mathod as transform operator for that matrix.</p></li>
</ul>
</div>
</section>
<section id="leadingdimension-operator">
<span id="leadingdimension-operator-label"></span><h3>LeadingDimension Operator<a class="headerlink" href="#leadingdimension-operator" title="Link to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cublasdx</span><span class="o">::</span><span class="n">LeadingDimension</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">LDA</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">LDB</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">LDC</span><span class="o">&gt;</span><span class="p">()</span>
</pre></div>
</div>
<p>Defines leading dimensions for matrices <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code>, and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code>.
The leading dimension of a matrix is a stride (in elements) to the beginning of the next column for a column-major matrix
or the next row for a row-major matrix.</p>
<p>If <a class="reference internal" href="#arrangement-operator-label"><span class="std std-ref">Arrangement</span></a> is used in the description of a <a class="reference internal" href="#function-operator-gemm-label"><span class="std std-ref">general matrix multiplication</span></a>
operation,  <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> matrices can be described in a following way:</p>
<ul class="simple">
<li><p>Real dimensions of matrix <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> are <span class="math notranslate nohighlight">\(LDA\times K\)</span> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDA</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">M</span></code> if <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> is column-major, and <span class="math notranslate nohighlight">\(LDA\times M\)</span> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDA</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">K</span></code> otherwise.</p></li>
<li><p>Real dimensions of matrix <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code> are <span class="math notranslate nohighlight">\(LDB\times N\)</span> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDA</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">K</span></code> if <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code> is column-major, and <span class="math notranslate nohighlight">\(LDB\times K\)</span> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDB</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">N</span></code> otherwise.</p></li>
<li><p>Real dimensions of matrix <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> are <span class="math notranslate nohighlight">\(LDC\times N\)</span> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDC</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">M</span></code> if <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> is column-major, and <span class="math notranslate nohighlight">\(LDC\times M\)</span> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDB</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">N</span></code> otherwise.</p></li>
</ul>
<p>A matrix can also be described using a layout
(see <a class="reference external" href="https://github.com/NVIDIA/cutlass/blob/main/media/docs/cpp/cute/01_layout.md#cute-layouts">CuTe: Layout</a>), i.e. a pair of
integer tuples: shape and stride (distance between elements). In simple terms, a shape represents the number of elements in each dimension,
and stride represents distance between elements in each dimension.</p>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> - matrix of <span class="math notranslate nohighlight">\(M\times K\)</span> shape, with <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">1</span></code> stride in 1st dimension and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDA</span></code> in 2nd dimension if <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> is column-major, or with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDA</span></code> in 1st and <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">1</span></code> in 2nd dimension otherwise.</p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code> - matrix of <span class="math notranslate nohighlight">\(K\times N\)</span> shape, with <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">1</span></code> stride in 1st dimension and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDB</span></code> in 2nd dimension if <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code> is column-major, or with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDB</span></code> in 1st and <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">1</span></code> in 2nd dimension otherwise.</p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> - matrix of <span class="math notranslate nohighlight">\(M\times N\)</span> shape, with <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">1</span></code> stride in 1st dimension and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDC</span></code> in 2nd dimension if <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> is column-major, or with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDC</span></code> in 1st and <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">1</span></code> in 2nd dimension otherwise.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">TransposeMode</span></code> operator is deprecated since 0.2.0 and may be removed in future versions.</p>
</div>
<p>If <a class="reference internal" href="#transposemode-operator-label"><span class="std std-ref">TransposeMode</span></a> (deprecated) is used in the description of a <a class="reference internal" href="#function-operator-gemm-label"><span class="std std-ref">general matrix multiplication</span></a>
operation, in BLAS nomenclature the dimensions of the  <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> matrices can be described in a following way:</p>
<ul class="simple">
<li><p>Real dimensions of matrix <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> are <span class="math notranslate nohighlight">\(LDA\times K\)</span> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDA</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">M</span></code> if <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> is non-transposed, and <span class="math notranslate nohighlight">\(LDA\times M\)</span> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDA</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">K</span></code> otherwise.</p></li>
<li><p>Real dimensions of matrix <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code> are <span class="math notranslate nohighlight">\(LDB\times N\)</span> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDA</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">K</span></code> if <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code> is non-transposed, and <span class="math notranslate nohighlight">\(LDB\times K\)</span> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDB</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">N</span></code> otherwise.</p></li>
<li><p>Real dimensions of matrix <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> are <span class="math notranslate nohighlight">\(LDC\times N\)</span> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">LDC</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">M</span></code>.</p></li>
</ul>
<p>See also, <a class="reference internal" href="traits.html#suggested-leading-dimension-of-trait-label"><span class="std std-ref">suggested_leading_dimension_of</span></a>.</p>
</section>
<section id="alignment-operator">
<span id="alignment-operator-label"></span><h3>Alignment Operator<a class="headerlink" href="#alignment-operator" title="Link to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Alignment</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">AAlignment</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">BAlignment</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">CAlignment</span><span class="o">&gt;</span><span class="p">()</span>

<span class="n">cublasdx</span><span class="o">::</span><span class="n">MaxAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="o">&gt;</span><span class="w"> </span><span class="c1">// alias of maximum supported alignements</span>
</pre></div>
</div>
<p>Defines the alignments (in bytes) of the pointers to matrices <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code>, and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> (either raw pointers or wrapped in CuTe tensors) that are passed to the <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">execute</span><span class="p">(...)</span></code> method.</p>
<p>Note that the alignments have direct implication for how much shared memory is required for given a description operator.
Additionally, it may also impact the performance.</p>
<p>Requirements:</p>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">AAlignments</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BAlignments</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">CAlignments</span></code> should be powers-of-two and less than or equal to the maximum supported alignments, i.e., 16 bytes.</p></li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">AAlignments</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BAlignments</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">CAlignments</span></code> are multiple of alignment of either chosen compute value types, or input value types if decoupled precision is used.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If using computation precision decoupled from input types, the <a class="reference internal" href="#alignment-operator-label"><span class="std std-ref">Alignment Operator</span></a> must be explicitly set.</p>
</div>
<p>See also, <a class="reference internal" href="traits.html#suggested-alignment-trait-label"><span class="std std-ref">Suggested Alignment Trait</span></a>.</p>
</section>
<section id="function-operator">
<span id="function-operator-label"></span><h3>Function Operator<a class="headerlink" href="#function-operator" title="Link to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Function</span><span class="o">&lt;</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">function</span><span class="w"> </span><span class="n">F</span><span class="o">&gt;</span><span class="p">()</span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">cublasdx</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">enum</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">function</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">MM</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Sets the BLAS function to be executed.</p>
<section id="general-matrix-multiply">
<span id="function-operator-gemm-label"></span><h4>General Matrix Multiply<a class="headerlink" href="#general-matrix-multiply" title="Link to this heading">#</a></h4>
<p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Function</span><span class="o">&lt;</span><span class="n">function</span><span class="o">::</span><span class="n">MM</span><span class="o">&gt;</span></code> sets the operation to general matrix multiply, defined as one of:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{C}_{m\times n} = {\alpha} \times \mathbf{A}_{m\times k} \times \mathbf{B}_{k\times n} + {\beta} \times \mathbf{C}_{m\times n}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{C}_{m\times n} = \mathbf{A}_{m\times k} \times \mathbf{B}_{k\times n} + \mathbf{C}_{m\times n}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{C}_{m\times n} = \mathbf{A}_{m\times k} \times \mathbf{B}_{k\times n}\)</span></p></li>
</ol>
<p>where <span class="math notranslate nohighlight">\({\alpha}\)</span> and <span class="math notranslate nohighlight">\({\beta}\)</span> are scalars (real or complex), and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">B</span></code>, and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">C</span></code> are matrices
with dimensions <span class="math notranslate nohighlight">\(A: m\times k\)</span>, <span class="math notranslate nohighlight">\(B: k\times n\)</span>, and <span class="math notranslate nohighlight">\(C: m\times n\)</span>, respectively.</p>
<p>The matrices can be column-major, row-major, or have a custom layout. See <a class="reference internal" href="methods.html#execution-methods-label"><span class="std std-ref">Execution Methods</span></a>,
<a class="reference internal" href="other_methods.html#get-layout-other-label"><span class="std std-ref">Get Memory Layout</span></a>, <a class="reference internal" href="other_methods.html#suggest-layout-other-label"><span class="std std-ref">Suggested shared memory Layout</span></a>, and <a class="reference internal" href="#arrangement-operator-label"><span class="std std-ref">Arrangement</span></a>.</p>
</section>
</section>
<section id="sm-operator">
<span id="sm-operator-label"></span><h3>SM Operator<a class="headerlink" href="#sm-operator" title="Link to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cublasdx</span><span class="o">::</span><span class="n">SM</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">CC</span><span class="o">&gt;</span><span class="p">()</span>
</pre></div>
</div>
<p>Sets the target architecture <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">CC</span></code> for the underlying BLAS function to use. Supported architectures are:</p>
<ul class="simple">
<li><p>Volta: <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">700</span></code> and <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">720</span></code> (sm_70, sm_72).</p></li>
<li><p>Turing: <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">750</span></code> (sm_75).</p></li>
<li><p>Ampere: <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">800</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">860</span></code> and <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">870</span></code> (sm_80, sm_86, sm_87).</p></li>
<li><p>Ada: <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">890</span></code> (sm_89).</p></li>
<li><p>Hopper: <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">900</span></code> (sm_90).</p></li>
<li><p>Blackwell: <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">1000</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">1010</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">1030</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">1200</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="mi">1210</span></code> (sm_100, sm_101, sm_103, sm_120, sm_121).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When compiling for <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">XYa</span></code> or <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">XYf</span></code> compute capability use <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">XY0</span></code> in the <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">SM</span></code> operator (see also <a class="reference external" href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#feature-availability">CUDA C++ Programming Guide: Feature Availability</a>).</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Starting with cuBLASDx 0.4.0, support for NVIDIA Xavier Tegra SoC (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">SM</span><span class="o">&lt;</span><span class="mi">720</span><span class="o">&gt;</span></code> or <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">sm_72</span></code>) is deprecated.
Additionally, support for architectures sm_103 and sm_121 is experimental in this release.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is not guaranteed that executions of exactly the same BLAS function with exactly the same inputs on GPUs of different
CUDA architectures will produce bit-identical results.</p>
</div>
<hr class="docutils" />
</section>
</section>
<section id="execution-operators">
<span id="execution-operators-label"></span><h2>Execution Operators<a class="headerlink" href="#execution-operators" title="Link to this heading">#</a></h2>
<p>Execution operators configure how the function will run on the GPU. Combined with <a class="reference internal" href="#description-operators-label"><span class="std std-ref">Description Operators</span></a>, they form a
complete function descriptor that can be executed on a GPU.</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#block-operator-label"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Block</span></code></a></p></td>
<td><p>Creates block execution object. See <a class="reference internal" href="#block-configuration-operators">Block Configuration Operators</a>.</p></td>
</tr>
</tbody>
</table>
</div>
<section id="block-operator">
<span id="block-operator-label"></span><h3>Block Operator<a class="headerlink" href="#block-operator" title="Link to this heading">#</a></h3>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Block</span><span class="p">()</span>
</pre></div>
</div>
<p>Generates a collective operation to run in a single CUDA block.
Threads will cooperate to compute the collective operation.
The layout and the number of threads participating in the execution, can be configured using <a class="reference internal" href="#block-configuration-operators">Block Configuration Operators</a>.</p>
<p>For example, the following code example creates a function descriptor for GEMM function that will run in a single CUDA block:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cublasdx.hpp&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="n">GEMM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">decltype</span><span class="p">(</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Size</span><span class="o">&lt;</span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">64</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Precision</span><span class="o">&lt;</span><span class="kt">double</span><span class="p">,</span><span class="w"> </span><span class="n">__half</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Type</span><span class="o">&lt;</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">type</span><span class="o">::</span><span class="n">real</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">TransposeMode</span><span class="o">&lt;</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">N</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Function</span><span class="o">&lt;</span><span class="n">cublasdx</span><span class="o">::</span><span class="n">function</span><span class="o">::</span><span class="n">MM</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">SM</span><span class="o">&lt;</span><span class="mi">700</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">              </span><span class="o">+</span><span class="w"> </span><span class="n">cublasdx</span><span class="o">::</span><span class="n">Block</span><span class="p">());</span>
</pre></div>
</div>
</section>
<section id="block-configuration-operators">
<h3>Block Configuration Operators<a class="headerlink" href="#block-configuration-operators" title="Link to this heading">#</a></h3>
<p>Block-configuration operators allow the user to configure block size of a single CUDA block.</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operators</p></th>
<th class="head"><p>Default value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#blockdim-operator-label"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="o">&gt;</span></code></a></p></td>
<td><p>Based on heuristics</p></td>
<td><p>Number of threads used to perform BLAS function.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Block configuration operators can only be used with <a class="reference internal" href="#block-operator-label"><span class="std std-ref">Block Operator</span></a>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is not guaranteed that executions of exactly the same BLAS function with exactly the same inputs but
with different</p>
<ul class="simple">
<li><p>leading dimensions (<a class="reference internal" href="#leadingdimension-operator-label"><span class="std std-ref">LeadingDimension</span></a>),</p></li>
<li><p>CUDA architecture (<a class="reference internal" href="#sm-operator-label"><span class="std std-ref">SM</span></a>), or</p></li>
<li><p>number of threads (<a class="reference internal" href="#blockdim-operator-label"><span class="std std-ref">BlockDim</span></a>)</p></li>
</ul>
<p>will produce bit-identical results.</p>
</div>
<section id="blockdim-operator">
<span id="blockdim-operator-label"></span><h4>BlockDim Operator<a class="headerlink" href="#blockdim-operator" title="Link to this heading">#</a></h4>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">cublasdx</span><span class="o">::</span><span class="n">BlockDim</span><span class="o">&lt;</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Z</span><span class="o">&gt;</span><span class="p">()</span>
</pre></div>
</div>
<p>Sets the CUDA block size to <code class="code highlight cpp docutils literal highlight-cpp"><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="p">)</span></code> to configure the execution, meaning it sets number of threads participating
in the execution and their layout.
Using this operator, user can run the BLAS function in 1D, 2D or 3D block with different number of threads.
Set block dimension can be accessed via <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BLAS</span><span class="o">::</span><span class="n">block_dim</span></code> trait.</p>
<p>Adding <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="o">&gt;</span></code> to the description puts the following requirements on the execution of the BLAS function:</p>
<ul class="simple">
<li><p>Kernel must be launched with 3D block dimensions <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="w"> </span><span class="n">Y1</span><span class="p">,</span><span class="w"> </span><span class="n">Z1</span><span class="p">)</span></code> where <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">X1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">X</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Y1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">Y</span></code>, and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Z1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">Z</span></code>, also:</p>
<ul>
<li><p>For 1D <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span></code> kernel must be launched with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="w"> </span><span class="n">Y1</span><span class="p">,</span><span class="w"> </span><span class="n">Z1</span><span class="p">)</span></code> where <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">X1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">X</span></code>.</p></li>
<li><p>For 2D <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="o">&gt;</span></code> kernel must be launched with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Y1</span><span class="p">,</span><span class="w"> </span><span class="n">Z1</span><span class="p">)</span></code> where <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Y1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">Y</span></code>.</p></li>
<li><p>For 3D <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">Z</span><span class="o">&gt;</span></code> kernel must be launched with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">Z1</span><span class="p">)</span></code> where <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Z1</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">Z</span></code>.</p></li>
</ul>
</li>
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">X</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Z</span></code> threads must be participating in the execution.</p></li>
<li><p>The participating threads must be consecutive (adjacent) threads.</p></li>
</ul>
<p>The listed requirements may be lifted or loosened in the future releases of cuBLASDx.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>cuBLASDx can’t validate all kernel launch configuration at runtime and check that all requirements are met, thus it is
user responsibility to adhere to the rules listed above. Violating those rules is considered undefined behavior and can lead to
incorrect results and/or failures.</p>
</div>
<div class="hint admonition">
<p class="admonition-title">Examples</p>
<div class="line-block">
<div class="line"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span></code>, kernel launched with block dimensions <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span></code> - OK</div>
<div class="line"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span></code>, kernel launched with block dimensions <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span></code> - OK</div>
<div class="line"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span></code>, kernel launched with block dimensions <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span></code> - OK</div>
<div class="line"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="o">&gt;</span></code>, kernel launched with block dimensions <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span></code> - OK</div>
<div class="line"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="o">&gt;</span></code>, kernel launched with block dimensions <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span></code> - OK</div>
<div class="line"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">&gt;</span></code>, kernel launched with block dimensions <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span></code> - OK</div>
<div class="line"><br /></div>
<div class="line"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span></code>, kernel launched with block dimensions <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span></code> - INCORRECT</div>
<div class="line"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">64</span><span class="o">&gt;</span></code>, kernel launched with block dimensions <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span></code> - INCORRECT</div>
<div class="line"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="o">&gt;</span></code>, kernel launched with block dimensions <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span></code> - INCORRECT</div>
<div class="line"><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="o">&gt;</span></code>, kernel launched with block dimensions <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">dim3</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span></code> - INCORRECT</div>
</div>
</div>
<p>The value of <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span></code> can be accessed from BLAS description via <a class="reference internal" href="traits.html#blockdim-block-trait-label"><span class="std std-ref">BLAS::block_dim</span></a> trait.
When <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span></code> is not set, the default block dimensions are used
(the default value is <a class="reference internal" href="traits.html#suggestedblockdim-block-trait-label"><span class="std std-ref">BLAS::suggested_block_dim</span></a>).</p>
<p>If the default block dimensions provided by cuBLASDx is smaller than the ones optimal for a kernel, it may
still be optimal to try the default before increasing the number of threads contributing to the calculations.</p>
<div class="attention admonition">
<p class="admonition-title">Restrictions</p>
<ul class="simple">
<li><p><code class="code highlight cpp docutils literal highlight-cpp"><span class="n">X</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Z</span></code> must be greater than or equal to 32.</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>It’s recommended that <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">X</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Z</span></code> is 32, 64, 128, 256, 512, or 1024.</p></li>
<li><p>It’s recommended that <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">X</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Z</span></code> is a multiple of 32.</p></li>
</ul>
</div>
</section>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../performance.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Achieving High Performance</p>
      </div>
    </a>
    <a class="right-next"
       href="traits.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Traits</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            


              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description-operators">Description Operators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#size-operator">Size Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-operator">Type Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precision-operator">Precision Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#arrangement-operator">Arrangement Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transposemode-operator">TransposeMode Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#leadingdimension-operator">LeadingDimension Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alignment-operator">Alignment Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-operator">Function Operator</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#general-matrix-multiply">General Matrix Multiply</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sm-operator">SM Operator</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execution-operators">Execution Operators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#block-operator">Block Operator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#block-configuration-operators">Block Configuration Operators</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#blockdim-operator">BlockDim Operator</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            

          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
<a class="footer-brand logo" href="https://www.nvidia.com">
  <img src="../_static/nvidia-logo-horiz-rgb-1c-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA"/>
  <img src="../_static/nvidia-logo-horiz-rgb-1c-wht-for-screen.svg" class="logo__image only-dark" alt="NVIDIA"/>
</a></div>
      
        <div class="footer-item">

<div class="footer-links">
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/">Privacy Policy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/">Manage My Privacy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/preferences/start/">Do Not Sell or Share My Data</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/">Terms of Service</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/accessibility/">Accessibility</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/company-policies/">Corporate Policies</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/product-security/">Product Security</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/contact/">Contact</a>
  
  
  
</div>
</div>
      
        <div class="footer-item">




  <p class="copyright">
    
      Copyright © 2022-2025, NVIDIA Corporation &amp; Affiliates. All rights reserved.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>