

<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Linear System Solver Using cuSolverDx &#8212; cuSOLVERDx</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/nvidia-sphinx-theme.css?v=df3ac72c" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=1be0d999"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'get_started/introduction';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.nvidia.com/cuda/cusolverdx/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.2.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="icon" href="../_static/nvidia.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Achieving High Performance" href="performance.html" />
    <link rel="prev" title="Triangular Matrix-Matrix Solve" href="trsm.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.2.0" />


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="cuSOLVERDx - Home"/>
    <img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="cuSOLVERDx - Home"/>
  
  
    <p class="title logo__title">cuSOLVERDx</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="cuSOLVERDx - Home"/>
    <img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="cuSOLVERDx - Home"/>
  
  
    <p class="title logo__title">cuSOLVERDx</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">



<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Documentation Home</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="requirement.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="functionality.html">Functionality</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="potrf.html">Cholesky POTRF</a></li>
<li class="toctree-l2"><a class="reference internal" href="potrs.html">Cholesky POTRS</a></li>
<li class="toctree-l2"><a class="reference internal" href="posv.html">Cholesky POSV</a></li>
<li class="toctree-l2"><a class="reference internal" href="getrf.html">LU GETRF</a></li>
<li class="toctree-l2"><a class="reference internal" href="getrs.html">LU GETRS</a></li>
<li class="toctree-l2"><a class="reference internal" href="gesv.html">LU GESV</a></li>
<li class="toctree-l2"><a class="reference internal" href="geqrf.html">QR GEQRF</a></li>
<li class="toctree-l2"><a class="reference internal" href="unmqr.html">QR UNMQR</a></li>
<li class="toctree-l2"><a class="reference internal" href="gelqf.html">LQ GELQF</a></li>
<li class="toctree-l2"><a class="reference internal" href="unmlq.html">LQ UNMLQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="gels.html">Least Squares GELS</a></li>
<li class="toctree-l2"><a class="reference internal" href="trsm.html">Triangular Solve TRSM</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Using cuSolverDx</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Achieving High Performance</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/operators.html">Operators</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/description_ops.html">Description Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/execution_ops.html">Execution Operators</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/traits.html">Traits</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/description_traits.html">Description Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/execution_traits.html">Execution Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/other_traits.html">Other Traits</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../api/methods.html">Execution Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/other_methods.html">Other Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/other_shared.html">Shared Memory Management</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../python_bindings.html">Python Bindings</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/index.html">Examples List</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/intro_example.html">Introduction Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/potr_example.html">Cholesky Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/lu_example.html">LU Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/qr_example.html">QR and GELS Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/nvrtc_example.html">NVRTC Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/performance_example.html">Performance Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/advanced_example.html">Advanced Examples</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/NVIDIA/CUDALibrarySamples/tree/master/MathDx/cuSolverDx">GitHub Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">MathDx</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://developer.nvidia.com/cusolverdx-downloads">cuSolverDx</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.nvidia.com/cublasdx-downloads">cuBLASDx</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.nvidia.com/cufftdx-downloads">cuFFTDx</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.nvidia.com/curanddx-downloads">cuRANDDx</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.nvidia.com/nvcompdx-downloads">nvCOMPDx</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Linear System Solver Using cuSolverDx</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="linear-system-solver-using-cusolverdx">
<span id="intro"></span><h1>Linear System Solver Using cuSolverDx<a class="headerlink" href="#linear-system-solver-using-cusolverdx" title="Link to this heading">#</a></h1>
<p>In this introduction, we will perform a batched linear system solver based on Cholesky factorization using the cuSolverDx library. This section is based on the <a class="reference internal" href="../examples/intro_example.html#intro-example"><span class="std std-ref">Introduction Example</span></a> shipped with cuSolverDx.
Refer to <a class="reference internal" href="../examples/index.html#examples"><span class="std std-ref">Examples</span></a> section for other cuSolverDx samples.</p>
<section id="defining-a-function-descriptor">
<h2>Defining a Function Descriptor<a class="headerlink" href="#defining-a-function-descriptor" title="Link to this heading">#</a></h2>
<p>NVIDIA MathDX uses a list of <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">operators</span></code> to create a full description of the function to solve. Therefore, the first step is defining a function descriptor by adding together cuSolverDx operators that capture the properties of the function.
The correctness of this description is evaluated at compile time.</p>
<p>A well-defined cuSolverDx routine description must include two parts:</p>
<ol class="arabic simple">
<li><p>Selected linear algebra routine. In this case it is Cholesky decomposition and solver: <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">cusolverdx</span><span class="o">::</span><span class="n">function</span><span class="o">::</span><span class="n">posv</span></code>.</p></li>
<li><p>Valid and sufficient description of the input/output matrices, including the dimensions (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">m</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">n</span></code>, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">nrhs</span></code>), the precision (<code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">float</span></code> or <code class="code highlight cpp docutils literal highlight-cpp"><span class="kt">double</span></code>), the data type (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">real</span></code> or <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">complex</span></code>), the fill mode (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">lower</span></code> or <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">upper</span></code>), and the data arrangement of matrices (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">row</span><span class="o">-</span></code> or <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">column</span></code>-major).</p></li>
</ol>
<p>To get a descriptor for <a class="reference internal" href="posv.html#posv"><span class="std std-ref">Cholesky Solver</span></a> with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span></code>, and <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">nrhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span></code>, we just need to write the following lines:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cusolverdx.hpp&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">cusolverdx</span><span class="p">;</span>

<span class="k">using</span><span class="w"> </span><span class="n">POSV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">decltype</span><span class="p">(</span><span class="n">Size</span><span class="o">&lt;</span><span class="mi">32</span><span class="w"> </span><span class="cm">/* = m */</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="cm">/* = n */</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="cm">/* = k */</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Precision</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Type</span><span class="o">&lt;</span><span class="n">type</span><span class="o">::</span><span class="n">complex</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">function</span><span class="o">::</span><span class="n">posv</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">FillMode</span><span class="o">&lt;</span><span class="n">lower</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Arrangement</span><span class="o">&lt;</span><span class="n">col_major</span><span class="w"> </span><span class="cm">/* A, X, and B */</span><span class="o">&gt;</span><span class="p">());</span>
</pre></div>
</div>
<p>In order to encode the operation properties, cuSolverDx provides operators
<a class="reference internal" href="../api/description_ops.html#size-operator-label"><span class="std std-ref">Size</span></a>,
<a class="reference internal" href="../api/description_ops.html#precision-operator-label"><span class="std std-ref">Precision</span></a>,
<a class="reference internal" href="../api/description_ops.html#type-operator-label"><span class="std std-ref">Type</span></a>,
<a class="reference internal" href="../api/description_ops.html#function-operator-label"><span class="std std-ref">Function</span></a>,
<a class="reference internal" href="../api/description_ops.html#fillmode-operator-label"><span class="std std-ref">FillMode</span></a>, and
<a class="reference internal" href="../api/description_ops.html#arrangement-operator-label"><span class="std std-ref">Arrangement</span></a>,
which can be combined by using addition (<code class="code highlight cpp docutils literal highlight-cpp"><span class="o">+</span></code>).</p>
<p>Optionally, user can set leading dimensions for each matrix using <a class="reference internal" href="../api/description_ops.html#leadingdimension-operator-label"><span class="std std-ref">LeadingDimension</span></a> operator, or set them dynamically during the execution.</p>
<p>To obtain a fully usable operation that executes the function on CUDA block level, we need to provide at least two additional pieces of information:</p>
<ul class="simple">
<li><p>The first one is the <a class="reference internal" href="../api/description_ops.html#sm-operator-label"><span class="std std-ref">SM operator</span></a> which indicates the targeted CUDA architecture on which we want to run the function. Each GPU architecture is different, therefore each may use a different implementation and require different CUDA block size for the best performance. In the <a class="reference internal" href="../examples/intro_example.html#intro-example"><span class="std std-ref">posv_batched.cu</span></a> example this is passed as template parameter, but in this example we can assume we’re targeting A100 GPUs (<code class="code highlight cpp docutils literal highlight-cpp"><span class="n">SM</span><span class="o">&lt;</span><span class="mi">800</span><span class="o">&gt;</span><span class="p">()</span></code>).</p></li>
<li><p>Secondly, use the <a class="reference internal" href="../api/execution_ops.html#block-operator-label"><span class="std std-ref">Block Operator</span></a> to show that the routine will be performed by multiple threads in a single CUDA block. At this point, cuSolverDx performs additional verifications to make sure provided description is valid and that it is possible to execute it on the requested architecture.</p></li>
</ul>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cusolverdx.hpp&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">cusolverdx</span><span class="p">;</span>

<span class="k">using</span><span class="w"> </span><span class="n">POSV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">decltype</span><span class="p">(</span><span class="n">Size</span><span class="o">&lt;</span><span class="mi">32</span><span class="w"> </span><span class="cm">/* = m */</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="cm">/* = n */</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="cm">/* = k */</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Precision</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Type</span><span class="o">&lt;</span><span class="n">type</span><span class="o">::</span><span class="n">complex</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">function</span><span class="o">::</span><span class="n">posv</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">FillMode</span><span class="o">&lt;</span><span class="n">lower</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Arrangement</span><span class="o">&lt;</span><span class="n">col_major</span><span class="w"> </span><span class="cm">/* A, X, and B */</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">SM</span><span class="o">&lt;</span><span class="mi">800</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Block</span><span class="p">());</span>
</pre></div>
</div>
<p>Optionally user can also specify the number of threads that will be performing the Solver. This is done with the <a class="reference internal" href="../api/execution_ops.html#blockdim-operator-label"><span class="std std-ref">BlockDim operator</span></a>. If <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span></code> operator is not used, cuSolverDx will select preferred block size that can be obtained with <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Solver</span><span class="o">::</span><span class="n">block_dim</span></code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If there is no need to set custom block dimensions, it is recommended not to use <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">BlockDim</span></code> operator and rely on <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Solver</span><span class="o">::</span><span class="n">block_dim</span></code>. For more details, see <a class="reference internal" href="../api/methods.html#block-execute-method-label"><span class="std std-ref">Block Execute Method</span></a> section, <a class="reference internal" href="../api/execution_ops.html#blockdim-operator-label"><span class="std std-ref">BlockDim</span></a>, and <a class="reference internal" href="../api/other_traits.html#suggestedblockdim-block-trait-label"><span class="std std-ref">Suggested block dim</span></a>.</p>
</div>
</section>
<section id="executing-the-function">
<h2>Executing the Function<a class="headerlink" href="#executing-the-function" title="Link to this heading">#</a></h2>
<p>Class <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Solver</span></code> which describes the function can be instantiated into object (or objects).
Forming the object has no computational cost, and should be seen as a handle.
The function descriptor object provides a compute method, <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">execute</span><span class="p">(...)</span></code> that performs the requested function.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cusolverdx.hpp&gt;</span>
<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">cusolverdx</span><span class="p">;</span>

<span class="k">using</span><span class="w"> </span><span class="n">POSV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">decltype</span><span class="p">(</span><span class="n">Size</span><span class="o">&lt;</span><span class="mi">32</span><span class="w"> </span><span class="cm">/* = m */</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="cm">/* = n */</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="cm">/* = k */</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Precision</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Type</span><span class="o">&lt;</span><span class="n">type</span><span class="o">::</span><span class="n">complex</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">function</span><span class="o">::</span><span class="n">posv</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">FillMode</span><span class="o">&lt;</span><span class="n">lower</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Arrangement</span><span class="o">&lt;</span><span class="n">col_major</span><span class="w"> </span><span class="cm">/* A, X, and B */</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">SM</span><span class="o">&lt;</span><span class="mi">800</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Block</span><span class="p">());</span>

<span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">posv_kernel</span><span class="p">(</span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Solver</span><span class="o">::</span><span class="n">status_type</span><span class="o">*</span><span class="w"> </span><span class="n">info</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// copy A and B from global memory to shared memory</span>

<span class="w">      </span><span class="c1">// Execute Solver</span>
<span class="w">      </span><span class="n">Solver</span><span class="p">().</span><span class="n">execute</span><span class="p">(</span><span class="n">A_smem</span><span class="p">,</span><span class="w"> </span><span class="n">B_smem</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// copy the output A and B from shared memory to global memory</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If Cholesky factorization failed, i.e. some leading minor of <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> is not positive definite, the output parameter <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">info</span></code> would indicate smallest leading minor of <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">A</span></code> which is not positive definite for each batch.</p>
<p>As shown in the comments, the execution method assumes that all the matrices reside in the shared memory. It is up to the users to load the matrices from global to shared memory before calling the execution method, and are responsible for saving the results. In the examples shipped with cuSolverDx, there are common utility functions of load and store provided for users’ convenience.</p>
</section>
<section id="launching-the-kernel">
<h2>Launching the Kernel<a class="headerlink" href="#launching-the-kernel" title="Link to this heading">#</a></h2>
<p>To launch a kernel executing the defined <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Solver</span></code> we need to know the required block dimensions and the amount of shared memory needed.
The required shared memory can be obtained using <code class="code highlight cpp docutils literal highlight-cpp"><span class="n">Solver</span><span class="o">::</span><span class="n">shared_memory_size</span></code>. It accounts for any padding declared using <a class="reference internal" href="../api/description_ops.html#leadingdimension-operator-label"><span class="std std-ref">LeadingDimension Operator</span></a>.</p>
<p>For simplicity, the example below shows only the main component of the code.
Please check the full <a class="reference internal" href="../examples/intro_example.html#intro-example"><span class="std std-ref">example</span></a>, as well as <a class="reference internal" href="../examples/index.html#examples"><span class="std std-ref">others</span></a> shipped with cuSolverDx.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="nc">POSV</span><span class="p">,</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">BatchesPerBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">         </span><span class="k">class</span><span class="w"> </span><span class="nc">DataType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">POSV</span><span class="o">::</span><span class="n">a_data_type</span><span class="o">&gt;</span>
<span class="n">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">posv_kernel</span><span class="p">(</span><span class="n">DataType</span><span class="o">*</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">lda_gmem</span><span class="p">,</span>
<span class="w">                            </span><span class="n">DataType</span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">ldb_gmem</span><span class="p">,</span>
<span class="w">                            </span><span class="k">typename</span><span class="w"> </span><span class="nc">POSV</span><span class="o">::</span><span class="n">status_type</span><span class="o">*</span><span class="w"> </span><span class="n">info</span><span class="p">,</span>
<span class="w">                            </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">batches</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">cusolverdx</span><span class="p">;</span>
<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">m</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">POSV</span><span class="o">::</span><span class="n">m_size</span><span class="p">;</span>
<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">nrhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">POSV</span><span class="o">::</span><span class="n">k_size</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w">     </span><span class="n">one_batch_size_a_gmem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lda_gmem</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w">     </span><span class="n">one_batch_size_b_gmem</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="p">(</span><span class="n">arrangement_of_v_b</span><span class="o">&lt;</span><span class="n">POSV</span><span class="o">&gt;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">arrangement</span><span class="o">::</span><span class="n">col_major</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">ldb_gmem</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrhs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ldb_gmem</span><span class="p">;</span>

<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">lda_smem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">POSV</span><span class="o">::</span><span class="n">lda</span><span class="p">;</span>
<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">ldb_smem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">POSV</span><span class="o">::</span><span class="n">ldb</span><span class="p">;</span>
<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">one_batch_size_a_smem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lda_smem</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">one_batch_size_b_smem</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="p">(</span><span class="n">arrangement_of_v_b</span><span class="o">&lt;</span><span class="n">POSV</span><span class="o">&gt;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">arrangement</span><span class="o">::</span><span class="n">col_major</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">ldb_smem</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrhs</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ldb_smem</span><span class="p">;</span>

<span class="w">    </span><span class="k">extern</span><span class="w"> </span><span class="n">__shared__</span><span class="w"> </span><span class="nf">__align__</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">DataType</span><span class="p">))</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">shared_mem</span><span class="p">[];</span>

<span class="w">    </span><span class="n">DataType</span><span class="o">*</span><span class="w"> </span><span class="n">As</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">DataType</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">shared_mem</span><span class="p">);</span>
<span class="w">    </span><span class="n">DataType</span><span class="o">*</span><span class="w"> </span><span class="n">Bs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">As</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">one_batch_size_a_smem</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">BatchesPerBlock</span><span class="p">;</span>

<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">batch_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">blockIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">BatchesPerBlock</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">batch_idx</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">batches</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>

<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">Ag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kt">size_t</span><span class="p">(</span><span class="n">one_batch_size_a_gmem</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">batch_idx</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">Bg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="kt">size_t</span><span class="p">(</span><span class="n">one_batch_size_b_gmem</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">batch_idx</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Load data from global memory to registers</span>
<span class="w">    </span><span class="n">common</span><span class="o">::</span><span class="n">io</span><span class="o">&lt;</span><span class="n">POSV</span><span class="p">,</span><span class="w"> </span><span class="n">BatchesPerBlock</span><span class="o">&gt;::</span><span class="n">load</span><span class="p">(</span><span class="n">Ag</span><span class="p">,</span><span class="w"> </span><span class="n">lda_gmem</span><span class="p">,</span><span class="w"> </span><span class="n">As</span><span class="p">,</span><span class="w"> </span><span class="n">lda_smem</span><span class="p">);</span>
<span class="w">    </span><span class="n">common</span><span class="o">::</span><span class="n">io</span><span class="o">&lt;</span><span class="n">POSV</span><span class="p">,</span><span class="w"> </span><span class="n">BatchesPerBlock</span><span class="o">&gt;::</span><span class="n">load_rhs</span><span class="p">(</span><span class="n">Bg</span><span class="p">,</span><span class="w"> </span><span class="n">ldb_gmem</span><span class="p">,</span><span class="w"> </span><span class="n">Bs</span><span class="p">,</span><span class="w"> </span><span class="n">ldb_smem</span><span class="p">);</span>

<span class="w">    </span><span class="n">POSV</span><span class="p">().</span><span class="n">execute</span><span class="p">(</span><span class="n">As</span><span class="p">,</span><span class="w"> </span><span class="n">lda_smem</span><span class="p">,</span><span class="w"> </span><span class="n">Bs</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">info</span><span class="p">[</span><span class="n">batch_idx</span><span class="p">]);</span>

<span class="w">    </span><span class="c1">// store</span>
<span class="w">    </span><span class="n">common</span><span class="o">::</span><span class="n">io</span><span class="o">&lt;</span><span class="n">POSV</span><span class="p">,</span><span class="w"> </span><span class="n">BatchesPerBlock</span><span class="o">&gt;::</span><span class="n">store</span><span class="p">(</span><span class="n">As</span><span class="p">,</span><span class="w"> </span><span class="n">lda_smem</span><span class="p">,</span><span class="w"> </span><span class="n">Ag</span><span class="p">,</span><span class="w"> </span><span class="n">lda_gmem</span><span class="p">);</span>
<span class="w">    </span><span class="n">common</span><span class="o">::</span><span class="n">io</span><span class="o">&lt;</span><span class="n">POSV</span><span class="p">,</span><span class="w"> </span><span class="n">BatchesPerBlock</span><span class="o">&gt;::</span><span class="n">store_rhs</span><span class="p">(</span><span class="n">Bs</span><span class="p">,</span><span class="w"> </span><span class="n">ldb_smem</span><span class="p">,</span><span class="w"> </span><span class="n">Bg</span><span class="p">,</span><span class="w"> </span><span class="n">ldb_gmem</span><span class="p">);</span>
<span class="p">}</span>

<span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">posv_batched</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">POSV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">decltype</span><span class="p">(</span><span class="n">Size</span><span class="o">&lt;</span><span class="mi">32</span><span class="w"> </span><span class="cm">/* m = */</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="w"> </span><span class="cm">/* n = */</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="cm">/* nrhs = */</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Precision</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Type</span><span class="o">&lt;</span><span class="n">type</span><span class="o">::</span><span class="n">complex</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Function</span><span class="o">&lt;</span><span class="n">function</span><span class="o">::</span><span class="n">posv</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">FillMode</span><span class="o">&lt;</span><span class="n">lower</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Arrangement</span><span class="o">&lt;</span><span class="n">col_major</span><span class="w"> </span><span class="cm">/* A, X, and B */</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">SM</span><span class="o">&lt;</span><span class="mi">800</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">                      </span><span class="o">+</span><span class="w"> </span><span class="n">Block</span><span class="p">());</span>

<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">data_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">POSV</span><span class="o">::</span><span class="n">a_data_type</span><span class="p">;</span>

<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">m</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">POSV</span><span class="o">::</span><span class="n">m_size</span><span class="p">;</span>
<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">n</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">POSV</span><span class="o">::</span><span class="n">n_size</span><span class="p">;</span>
<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">nrhs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">POSV</span><span class="o">::</span><span class="n">k_size</span><span class="p">;</span>
<span class="w">    </span><span class="k">static_assert</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;posv is for Hermitian positive-definite matrix matrix only&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">lda_smem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">POSV</span><span class="o">::</span><span class="n">lda</span><span class="p">;</span>
<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">ldb_smem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">POSV</span><span class="o">::</span><span class="n">ldb</span><span class="p">;</span>

<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">lda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">ldb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">arrangement_of_v</span><span class="o">&lt;</span><span class="n">POSV</span><span class="o">&gt;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">arrangement</span><span class="o">::</span><span class="n">col_major</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">nrhs</span><span class="p">;</span>

<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">batches</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">one_batch_size_A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lda</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">one_batch_size_B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nrhs</span><span class="p">;</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">data_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">one_batch_size_A</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">batches</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// fill the A matrix</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">data_type</span><span class="o">&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">one_batch_size_B</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">batches</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// fill the B matrix</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">info</span><span class="p">(</span><span class="n">batches</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">data_type</span><span class="o">*</span><span class="w">       </span><span class="n">d_A</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w"> </span><span class="cm">/* device copy of A */</span>
<span class="w">    </span><span class="n">data_type</span><span class="o">*</span><span class="w">       </span><span class="n">d_B</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w"> </span><span class="cm">/* device copy of B */</span>
<span class="w">    </span><span class="kt">int</span><span class="o">*</span><span class="w">             </span><span class="n">d_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w"> </span><span class="cm">/* error info */</span>

<span class="w">    </span><span class="n">cudaMalloc</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">**&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_A</span><span class="p">),</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="w">    </span><span class="n">cudaMalloc</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">**&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_B</span><span class="p">),</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="w">    </span><span class="n">cudaMalloc</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">**&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_info</span><span class="p">),</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">batches</span><span class="p">);</span>

<span class="w">    </span><span class="n">cudaMemcpy</span><span class="p">(</span><span class="n">d_A</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">cudaMemcpyHostToDevice</span><span class="p">);</span>
<span class="w">    </span><span class="n">cudaMemcp</span><span class="p">(</span><span class="n">d_B</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">cudaMemcpyHostToDevice</span><span class="p">);</span>

<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">sm_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">POSV</span><span class="o">::</span><span class="n">shared_memory_size</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//Invokes kernel. Batches per block is 1</span>
<span class="w">    </span><span class="n">posv_kernel</span><span class="o">&lt;</span><span class="n">POSV</span><span class="o">&gt;&lt;&lt;&lt;</span><span class="n">batches</span><span class="p">,</span><span class="w"> </span><span class="n">POSV</span><span class="o">::</span><span class="n">block_dim</span><span class="p">,</span><span class="w"> </span><span class="n">sm_size</span><span class="o">&gt;&gt;&gt;</span><span class="p">(</span><span class="n">d_A</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">d_B</span><span class="p">,</span><span class="w"> </span><span class="n">ldb</span><span class="p">,</span><span class="w"> </span><span class="n">d_info</span><span class="p">);</span>

<span class="w">    </span><span class="n">cudaDeviceSynchronize</span><span class="p">();</span>

<span class="w">    </span><span class="n">cudaFree</span><span class="p">(</span><span class="n">d_A</span><span class="p">);</span>
<span class="w">    </span><span class="n">cudaFree</span><span class="p">(</span><span class="n">d_B</span><span class="p">);</span>
<span class="w">    </span><span class="n">cudaFree</span><span class="p">(</span><span class="n">d_info</span><span class="p">);</span>
<span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>It is important to note that unlike the cuSolver library, cuSolverDx does <strong>not</strong> require moving data back to global memory after executinga an operation, nor does it require the input data to be loaded from global memory. Those properties can be a major performance advantage for certain use-cases. The list of possible optimizations includes but is not limited to:</p>
<ul class="simple">
<li><p>Fusing Solver functions with custom pre- and post-processing.</p></li>
<li><p>Fusing multiple Solver functions together.</p></li>
<li><p>Fusing Solver functions with BLAS, RAND, or FFT operations.</p></li>
</ul>
</section>
<section id="compilation">
<h2>Compilation<a class="headerlink" href="#compilation" title="Link to this heading">#</a></h2>
<p>For instructions on how to compile programs with cuSolverDx see <a class="reference internal" href="installation.html#installation"><span class="std std-ref">Installation Guide</span></a>.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="trsm.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Triangular Matrix-Matrix Solve</p>
      </div>
    </a>
    <a class="right-next"
       href="performance.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Achieving High Performance</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            


              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-a-function-descriptor">Defining a Function Descriptor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#executing-the-function">Executing the Function</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#launching-the-kernel">Launching the Kernel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compilation">Compilation</a></li>
</ul>
  </nav></div>

</div></div>
              
            

          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
<a class="footer-brand logo" href="https://www.nvidia.com">
  <img src="../_static/nvidia-logo-horiz-rgb-1c-blk-for-screen.svg" class="logo__image only-light" alt="NVIDIA"/>
  <img src="../_static/nvidia-logo-horiz-rgb-1c-wht-for-screen.svg" class="logo__image only-dark" alt="NVIDIA"/>
</a></div>
      
        <div class="footer-item">

<div class="footer-links">
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-policy/">Privacy Policy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/privacy-center/">Manage My Privacy</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/preferences/start/">Do Not Sell or Share My Data</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/terms-of-service/">Terms of Service</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/accessibility/">Accessibility</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/about-nvidia/company-policies/">Corporate Policies</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/product-security/">Product Security</a>
   | 
  
  
  
  <a class="external" href="https://www.nvidia.com/en-us/contact/">Contact</a>
  
  
  
</div>
</div>
      
        <div class="footer-item">




  <p class="copyright">
    
      Copyright © 2024-2025, NVIDIA Corporation &amp; Affiliates. All rights reserved.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>